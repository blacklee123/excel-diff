{"version":3,"sources":["../node_modules/fibers sync","utils/ExcelHelper.ts","utils/Diff.ts","components/Left.tsx","components/Center.tsx","components/Cell.ts","utils/RenderDiffTable.tsx","components/DiffResult.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","SampleDataLeft","SampleDataRight","daff","require","LeftHooks","_ref","data","onFileSelectChange","onSheetSelectChange","props","fileList","maxCount","onRemove","file","beforeUpload","_jsxs","Space","direction","style","width","children","_jsx","Upload","Button","icon","UploadOutlined","HotTable","items","settings","minRows","minCols","colHeaders","rowHeaders","height","stretchH","licenseKey","workbook","Tabs","type","tabPosition","sheets","map","sheet","label","key","activeKey","sheetname","onChange","value","CenterHooks","onDiff","onSample","onReset","block","onClick","ref","React","createRef","Cell","constructor","instance","this","getCell","x","y","v","getDataAtCell","undefined","getValue","renderDiff","td","row","col","prop","cellProperties","daffTable","view","SimpleView","cellInfo","DiffRender","renderCell","className","category","innerHTML","pretty_value","DiffResultHooks","_Fragment","fontSize","textAlign","minSpareCols","minSpareRows","contextMenu","readOnly","renderAllRows","renderer","initialData","Array","fill","BlankData","App","leftDomain","setLeftDomain","useState","rightDomain","setRightDomain","diffData","setDiffData","fileHandler","field","Promise","reject","reader","FileReader","onload","_e$target","bstr","target","result","wb","XLSX","ws","Sheets","SheetNames","sheet_to_json","header","readAsArrayBuffer","convertFileToExcel","then","resp","onSheetFieldChange","selectedSheetName","getSheet","Layout","minHeight","Content","Row","gutter","padding","Col","span","display","alignItems","justifyContent","diff","left","right","console","table","tableLeft","TableView","tableRight","trim","alignment","compareTables","align","table_diff","flags","CompareFlags","show_unchanged","always_show_header","always_show_order","never_show_order","unchanged_context","TableDiff","hilite","diff2html","render","table_diff_html","html","onRset","length","Boolean","window","location","hostname","match","registerAllModules","ReactDOM","createRoot","document","getElementById","StrictMode","ConfigProvider","locale","zhCN","componentSize","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"yUAAA,SAASA,EAAoBC,GAC5B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBF,EAAM,KAEjD,MADAC,EAAEE,KAAO,mBACHF,CACP,CACAF,EAAoBK,KAAO,WAAa,MAAO,EAAI,EACnDL,EAAoBM,QAAUN,EAC9BO,EAAOC,QAAUR,EACjBA,EAAoBS,GAAK,G,2JCIlB,MAoCMC,EAAkB,CAC3B,CAAC,OAAQ,OAAQ,MAAO,QAAS,SAAU,MAAO,QAClD,CACE,sBACA,WACA,WACA,WACA,cACA,IACA,aAEF,CACE,sBACA,UACA,WACA,WACA,eACA,IACA,aAEF,CACE,sBACA,UACA,WACA,WACA,gBACA,IACA,aAEF,CACE,sBACA,WACA,WACA,UACA,gBACA,IACA,aAEF,CACE,sBACA,WACA,UACA,WACA,gBACA,IACA,cAIOC,EAAkB,CAC3B,CAAC,OAAQ,OAAQ,MAAO,QAAS,SAAU,MAAO,MAAO,OACzD,CACE,sBACA,WACA,UACA,WACA,cACA,IACA,IACA,KAEF,CACE,sBACA,UACA,WACA,WACA,eACA,IACA,IACA,KAEF,CACE,sBACA,UACA,WACA,WACA,gBACA,IACA,IACA,KAEF,CACE,sBACA,WACA,WACA,UACA,iBAEA,IACA,KAEF,CACE,sBACA,WACA,WACA,UACA,gBACA,IACA,IACA,KAEF,CACE,sBACA,WACA,UACA,WACA,gBACA,IACA,IACA,MC7JAC,EAAOC,EAAQ,K,kECmENC,MAnDmBC,IAI3B,IAJ4B,KACjCC,EAAI,mBACJC,EAAkB,oBAClBC,GACDH,EACC,MAUMI,EAAqB,CACzBC,SAAUJ,EAAKI,SACfC,SAAU,EACVC,SAAUC,IACRN,EAAmB,KAAK,EAE1BO,aAAcD,IACZN,EAAmBM,IACZ,IAIX,OACEE,eAACC,IAAK,CAACC,UAAU,WAAWC,MAAO,CAAEC,MAAO,QAASC,SAAA,CAInDC,cAACC,IAAM,IAAKb,EAAKW,SACfC,cAACE,IAAM,CAACC,KAAMH,cAACI,IAAc,IAAIL,SAAC,kBAEpCL,eAAA,OAAAK,SAAA,CACEC,cAACK,IAAQ,CAACpB,KAAMA,EAAKqB,MAAOC,SA/BiB,CACjDC,QAAS,GACTC,QAAS,EACTC,YAAY,EACZC,YAAY,EACZC,OAAQ,IACRC,SAAU,MACVC,WAAY,mCA0BN7B,EAAK8B,UAAYf,cAACgB,IAAI,CACpBC,KAAK,OACLC,YAAY,SACZZ,MAAOrB,EAAKkC,OAAOC,KAAKC,IAAK,CAAQC,MAAOD,EAAOE,IAAKF,MACxDG,UAAWvC,EAAKwC,UAChBC,SAAWC,GAAUxC,EAAoBwC,UAIzC,EC5CGC,MAVwB5C,IAAoC,IAAnC,OAAE6C,EAAM,SAAEC,EAAQ,QAAEC,GAAS/C,EACnE,OACEU,eAACC,IAAK,CAACC,UAAU,WAAWC,MAAO,CAAEC,MAAO,QAASC,SAAA,CACnDL,eAACQ,IAAM,CAAC8B,OAAK,EAACC,QAASH,EAAS/B,SAAA,CAAE,IAAE,aAAa,OACjDL,eAACQ,IAAM,CAAC8B,OAAK,EAACE,IAAKC,IAAMC,YAAanB,KAAK,UAAUgB,QAASJ,EAAO9B,SAAA,CAAE,IAAE,aAAa,OACtFL,eAACQ,IAAM,CAAC8B,OAAK,EAACE,IAAKC,IAAMC,YAAanB,KAAK,UAAUgB,QAASF,EAAQhC,SAAA,CAAE,IAAE,gBAAgB,SACpF,ECQGsC,MArBf,MAIEC,YAAYX,EAAeY,GAA8B,KAHzDZ,WAAK,OACLY,cAAQ,EAGNC,KAAKb,MAAQA,EACba,KAAKD,SAAWA,CAClB,CAEAE,QAAQC,EAAWC,GACjB,MAAMC,EAAIJ,KAAKD,SAASM,cAAcF,EAAGD,GACzC,OAAU,OAANE,EAAmBA,OACRE,IAANF,EAAwB,GAC1B,GAAKA,CACd,CAEAG,WACE,OAAOP,KAAKb,KACd,GClBF,MAAM9C,EAAOC,EAAQ,KAEd,SAASkE,EACdT,EACAU,EACAC,EACAC,EACAC,EACAzB,EACA0B,GAEA,MAAMC,EAAY,IAAIjB,EAAKV,EAAOY,GAC5BgB,EAAO,IAAI1E,EAAK2E,WAChBC,EAAW5E,EAAK6E,WAAWC,WAAWL,EAAWC,EAAMJ,EAAKD,GAClED,EAAGW,UAAYH,EAASI,SACxBZ,EAAGa,UAAYL,EAASM,YAC1B,CCoBeC,MA7B+BhF,IAAa,IAAZ,KAACC,GAAKD,EAenD,OACEU,eAAAuE,WAAA,CAAAlE,SAAA,CACEC,cAAA,OAAKH,MAAO,CAAEqE,SAAU,GAAIC,UAAW,UAAWpE,SAAE,6BACpDC,cAACK,IAAQ,CACPpB,KAAMA,EACNsB,SAnBoD,CAGxD6D,aAAc,EACdC,aAAc,EACd3D,YAAY,EACZ4D,aAAa,EACb3D,YAAY,EACZ4D,UAAU,EACVC,eAAe,EACf3D,SAAU,MACVC,WAAY,iCASR2D,SAAUzB,EACVY,UAAU,uBAGX,E,OCpBP,MAAMc,EAA2B,CAC/BjD,UAAW,SACXN,OAAQ,GACRb,OP2BwB4C,EO3BP,GP2BoBC,EO3BhB,EP4Bd,IAAIwB,MAAMzB,GAAK0B,KAAK,IAAIxD,KAAI,IAAM,IAAIuD,MAAMxB,GAAKyB,KAAK,OO3B7D7D,cAAU+B,EACVzD,SAAU,IPyBawF,IAAC3B,EAAaC,EOiExB2B,MAvFf,WAEE,MAAOC,EAAYC,GAAiBC,mBAAsBP,IACnDQ,EAAaC,GAAkBF,mBAAsBP,IAErDU,EAAUC,GAAeJ,mBAA4B,CAAC,GAAI,KAE3DK,EAAcA,CAAC9F,EAAqB+F,KAC3B,OAAT/F,EACY,SAAV+F,EACFP,EAAcN,GAEdS,EAAeT,GPtBYlF,IAC1B,IAAIgG,SAAQ,CAACjH,EAASkH,KAC3B,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,OAAS,SAAUzH,GAAI,IAAD0H,EAE3B,MAAMC,EAAQ,OAAD3H,QAAC,IAADA,GAAS,QAAR0H,EAAD1H,EAAG4H,cAAM,IAAAF,OAAR,EAADA,EAAWG,OAClBC,EAAKC,IAAUJ,EAAM,CAAE7E,KAAM,UAC7BkF,EAAKF,EAAGG,OAAOH,EAAGI,WAAW,IAE7BpH,EAAoB,CACxBwC,UAAWwE,EAAGI,WAAW,GACzB/F,MAAO4F,IAAWI,cAAcH,EAAI,CAAEI,OAAQ,IAC9CpF,OAAQ8E,EAAGI,WACXtF,SAAUkF,EACV5G,SAAU,CAACG,IAGbjB,EAAQU,EACV,EACAyG,EAAOc,kBAAkBhH,EAAK,IOM5BiH,CAAmBjH,GAAMkH,MAAMC,IACf,SAAVpB,EACFP,EAAc2B,GAEdxB,EAAewB,EACjB,GAEJ,EAGIC,EAAqBA,CAACC,EAA2BtB,KACrD,IAAIU,EAAe,SAAVV,EAAmBR,EAAWhE,SAAWmE,EAAYnE,SAE1DkF,GPfgBa,EAACb,EAAcxE,IAC9B,IAAI+D,SAAQ,SAAUjH,EAASkH,GACpC,IAAIU,EAAKF,EAAGG,OAAO3E,GAGnBlD,EADY2H,IAAWI,cAAcH,EAAI,CAAEI,OAAQ,IAErD,IOUIO,CAASb,EAAIY,GAAmBH,MAAMC,IACtB,SAAVpB,EACFP,EAAc,IAAKD,EAAYtD,UAAWoF,EAAmBvG,MAAOqG,IAEpExB,EAAe,IAAKD,EAAazD,UAAWoF,EAAmBvG,MAAOqG,GACxE,GAGJ,EAkBF,OACE3G,cAAC+G,IAAM,CAAClH,MAAO,CAAEmH,UAAW,SAAUjH,SACpCC,cAAC+G,IAAOE,QAAO,CAAAlH,SACbL,eAACwH,IAAG,CAACC,OAAQ,CAAC,GAAI,IAAKtH,MAAO,CAAEuH,QAAS,OAAQrH,SAAA,CAC/CC,cAACqH,IAAG,CAACC,KAAM,GAAGvH,SACZC,cAACjB,EAAS,CACRE,KAAM8F,EACN7F,mBAAqBf,GAAMmH,EAAYnH,EAAG,QAC1CgB,oBAAsBhB,GAAMyI,EAAmBzI,EAAG,YAGtD6B,cAACqH,IAAG,CAACC,KAAM,EAAGzH,MAAO,CAAE0H,QAAS,OAAQC,WAAY,SAAUC,eAAgB,UAAW1H,SACvFC,cAAC4B,EAAW,CAACC,OArBRA,KACbwD,ENnEgBqC,EAACC,EAAeC,KAClCC,QAAQC,MAAMH,GACdE,QAAQC,MAAMF,GACd,MAAMG,EAAY,IAAIlJ,EAAKmJ,UAAUL,GAC/BM,EAAa,IAAIpJ,EAAKmJ,UAAUJ,GAEtCG,EAAUG,OACVD,EAAWC,OAGX,MAAMC,EAAYtJ,EAAKuJ,cAAcL,EAAWE,GAAYI,QACtDC,EAAa,IAAIzJ,EAAKmJ,UAAU,IAEhCO,EAAQ,IAAI1J,EAAK2J,aACvBD,EAAME,gBAAiB,EACvBF,EAAMG,oBAAqB,EAC3BH,EAAMI,mBAAoB,EAC1BJ,EAAMK,kBAAmB,EACzBL,EAAMM,kBAAoB,EAEN,IAAIhK,EAAKiK,UAAUX,EAAWI,GACtCQ,OAAOT,GAEnB,MAAMU,EAAY,IAAInK,EAAK6E,WAC3BsF,EAAUC,OAAOX,GACjB,MAAMY,EAAkBF,EAAUG,OAGlC,OADAtB,QAAQC,MAAMoB,GACP,CAACZ,EAAWrJ,KAAMiK,EAAgB,EMuC3BxB,CAAK3C,EAAWzE,MAAO4E,EAAY5E,OAAO,EAoBjBwB,SAjBtBA,KACfkD,EAAc,IAAKD,EAAYzE,MAAO3B,IACtCwG,EAAe,IAAKD,EAAa5E,MAAO1B,GAAkB,EAeDmD,QA3B5CqH,KACbpE,EAAcN,GACdS,EAAeT,GACfW,EAAY,CAAC,GAAI,IAAI,MA0BfrF,cAACqH,IAAG,CAACC,KAAM,GAAGvH,SACZC,cAACjB,EAAS,CACRE,KAAMiG,EACNhG,mBAAqBf,GAAMmH,EAAYnH,EAAG,SAC1CgB,oBAAsBwC,GAAUiF,EAAmBjF,EAAO,aAI5DyD,EAAS,GAAGiE,OAAS,GAAKrJ,cAACqH,IAAG,CAACC,KAAM,GAAGvH,SACtCC,cAACgE,EAAe,CAAC/E,KAAMmG,EAAS,aAO9C,EC/FoBkE,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2D,2BCPNC,cAEAC,IAASC,WAAWC,SAASC,eAAe,SAAUd,OACpDjJ,cAACmC,IAAM6H,WAAU,CAAAjK,SACfC,cAACiK,IAAc,CACbC,OAAQC,IACRC,cAAc,SAAQrK,SAEtBC,cAAC8E,EAAG,SDwHJ,kBAAmBuF,WACrBA,UAAUC,cAAcC,MACrB7D,MAAK8D,IACJA,EAAaC,YAAY,IAE1BC,OAAMC,IACL9C,QAAQ8C,MAAMA,EAAMC,QAAQ,G","file":"static/js/main.c4b3935e.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 457;","import * as XLSX from \"xlsx\";\nimport type { WorkBook } from \"xlsx\";\nimport type { RcFile, UploadFile } from \"antd/lib/upload\";\n\nexport interface ExcelDomain {\n  sheetname: string;\n  items: any[][];\n  sheets: string[];\n  workbook: XLSX.WorkBook | undefined;\n  fileList: UploadFile[]\n}\n\nexport const convertFileToExcel = (file: RcFile): Promise<ExcelDomain> => {\n  return new Promise((resolve, reject) => {\n    var reader = new FileReader();\n    reader.onload = function (e) {\n      /* Parse data */\n      const bstr = e?.target?.result;\n      const wb = XLSX.read(bstr, { type: \"array\" });\n      const ws = wb.Sheets[wb.SheetNames[0]];\n\n      const data: ExcelDomain = {\n        sheetname: wb.SheetNames[0],\n        items: XLSX.utils.sheet_to_json(ws, { header: 1 }),\n        sheets: wb.SheetNames,\n        workbook: wb,\n        fileList: [file as UploadFile ]\n      };\n\n      resolve(data);\n    };\n    reader.readAsArrayBuffer(file);\n  });\n};\n\nexport const getSheet = (wb: WorkBook, sheetname: string): Promise<any[]> => {\n  return new Promise(function (resolve, reject) {\n    var ws = wb.Sheets[sheetname];\n    /* Convert array of arrays */\n    var items = XLSX.utils.sheet_to_json(ws, { header: 1 });\n    resolve(items);\n  });\n};\n\nexport const BlankData = (row: number, col: number): string[][] => {\n  return new Array(row).fill(\"\").map(() => new Array(col).fill(\"\"));\n};\n\nexport const SampleDataLeft  = [\n    [\"Date\", \"High\", \"Low\", \"Close\", \"Volume\", \"ask\", \"cash\"],\n    [\n      \"2019-07-08 00:00:00\",\n      \"11540.33\",\n      \"11469.53\",\n      \"11506.43\",\n      \"10.77073088\",\n      \"0\",\n      \"100000000\",\n    ],\n    [\n      \"2019-07-07 19:00:00\",\n      \"11610.0\",\n      \"11432.32\",\n      \"11547.98\",\n      \"67.915214697\",\n      \"0\",\n      \"100000000\",\n    ],\n    [\n      \"2019-07-07 18:00:00\",\n      \"11525.0\",\n      \"11426.74\",\n      \"11470.47\",\n      \"31.1094771869\",\n      \"0\",\n      \"100000000\",\n    ],\n    [\n      \"2019-07-07 16:00:00\",\n      \"11254.97\",\n      \"11135.01\",\n      \"11201.6\",\n      \"23.5194946648\",\n      \"0\",\n      \"100000000\",\n    ],\n    [\n      \"2019-07-07 15:00:00\",\n      \"11408.02\",\n      \"11189.0\",\n      \"11254.97\",\n      \"64.0821938629\",\n      \"0\",\n      \"100000000\",\n    ],\n  ];\n\nexport const SampleDataRight = [\n    [\"Date\", \"High\", \"Low\", \"Close\", \"Volume\", \"bid\", \"ask\", \"Buy\"],\n    [\n      \"2019-07-07 23:00:00\",\n      \"11482.72\",\n      \"11423.0\",\n      \"11475.07\",\n      \"32.99655899\",\n      \"6\",\n      \"0\",\n      \"3\",\n    ],\n    [\n      \"2019-07-07 19:00:00\",\n      \"11610.0\",\n      \"11432.32\",\n      \"11547.98\",\n      \"67.915214697\",\n      \"6\",\n      \"0\",\n      \"9\",\n    ],\n    [\n      \"2019-07-07 18:10:00\",\n      \"11525.0\",\n      \"11426.74\",\n      \"11470.47\",\n      \"31.1094771869\",\n      \"6\",\n      \"0\",\n      \"9\",\n    ],\n    [\n      \"2019-07-07 17:20:00\",\n      \"11566.23\",\n      \"11211.56\",\n      \"11503.4\",\n      \"121.5246740453\",\n\n      \"0\",\n      \"9\",\n    ],\n    [\n      \"2019-07-07 16:00:00\",\n      \"11254.97\",\n      \"11135.01\",\n      \"11200.6\",\n      \"23.5194946648\",\n      \"6\",\n      \"0\",\n      \"9\",\n    ],\n    [\n      \"2019-07-07 15:00:00\",\n      \"11408.02\",\n      \"11189.0\",\n      \"11254.97\",\n      \"64.0821938629\",\n      \"6\",\n      \"1\",\n      \"9\",\n    ],\n  ]","const daff = require(\"daff\");\n\nexport const diff = (left: any[][], right: any[][]) :[any[][], string] => {\n  console.table(left);\n  console.table(right);\n  const tableLeft = new daff.TableView(left);\n  const tableRight = new daff.TableView(right);\n\n  tableLeft.trim();\n  tableRight.trim();\n\n\n  const alignment = daff.compareTables(tableLeft, tableRight).align();\n  const table_diff = new daff.TableView([]);\n\n  const flags = new daff.CompareFlags();\n  flags.show_unchanged = false;\n  flags.always_show_header = true;\n  flags.always_show_order = true;\n  flags.never_show_order = false;\n  flags.unchanged_context = 3;\n\n  const highlighter = new daff.TableDiff(alignment, flags);\n  highlighter.hilite(table_diff);\n\n  const diff2html = new daff.DiffRender();\n  diff2html.render(table_diff);\n  const table_diff_html = diff2html.html();\n  // console.table(table_diff.data);\n  console.table(table_diff_html);\n  return [table_diff.data, table_diff_html]\n};\n","import React from \"react\";\nimport { Tabs, Space, Upload, Button } from \"antd\";\nimport { UploadOutlined } from '@ant-design/icons';\nimport type { RcFile, UploadProps } from 'antd/es/upload/interface';\n\nimport Handsontable from 'handsontable/base';\nimport { HotTable } from \"@handsontable/react\";\n\nimport type { ExcelDomain } from \"../utils/ExcelHelper\";\n\ninterface Left {\n  data: ExcelDomain;\n  onFileSelectChange(file: RcFile|null): any;\n  onSheetSelectChange(e: string): any;\n}\n\nconst LeftHooks: React.FC<Left> = ({\n  data,\n  onFileSelectChange,\n  onSheetSelectChange\n}) => {\n  const hotLeftSettings: Handsontable.GridSettings = {\n    minRows: 12,\n    minCols: 4,\n    colHeaders: true,\n    rowHeaders: true,\n    height: 305,\n    stretchH: \"all\",\n    licenseKey: \"non-commercial-and-evaluation\",\n  };\n\n  const props: UploadProps = {\n    fileList: data.fileList,\n    maxCount: 1,\n    onRemove: file=> {\n      onFileSelectChange(null)\n    },\n    beforeUpload: file => {\n      onFileSelectChange(file)\n      return false;\n    },\n    // fileList,\n  };\n  return (\n    <Space direction=\"vertical\" style={{ width: \"100%\" }}>\n      {/* <Input.Group compact>\n        <input ref={fileRef} type=\"file\" accept=\".xlsx\" onChange={(e) => onFileSelectChange(e)} />\n      </Input.Group> */}\n      <Upload {...props}>\n        <Button icon={<UploadOutlined />}>Select File</Button>\n      </Upload>\n      <div>\n        <HotTable data={data.items} settings={hotLeftSettings} />\n        {\n          data.workbook && <Tabs\n            type=\"card\"\n            tabPosition=\"bottom\"\n            items={data.sheets.map((sheet) => ({ label: sheet, key: sheet }))}\n            activeKey={data.sheetname}\n            onChange={(value) => onSheetSelectChange(value)}>\n          </Tabs>\n        }\n      </div>\n    </Space>\n  );\n};\n\nexport default LeftHooks;\n","import React from \"react\";\nimport { Button, Space } from \"antd\";\n\ninterface DiffBtn {\n  onDiff(): any;\n  onSample(): any;\n  onReset(): any;\n}\n\nconst CenterHooks: React.FC<DiffBtn> = ({ onDiff, onSample, onReset }) => {\n  return (\n    <Space direction=\"vertical\" style={{ width: \"100%\" }}>\n      <Button block onClick={onSample} > {\"< Sample >\"} </Button>\n      <Button block ref={React.createRef()} type=\"primary\" onClick={onDiff} > {\">> Diff <<\"} </Button>\n      <Button block ref={React.createRef()} type=\"default\" onClick={onReset} > {\" << reset >> \"} </Button>\n    </Space>\n  );\n};\n\nexport default CenterHooks;\n","import Handsontable from \"handsontable\";\n\nclass Cell {\n  value: string;\n  instance: Handsontable.Core;\n\n  constructor(value: string, instance: Handsontable.Core) {\n    this.value = value;\n    this.instance = instance;\n  }\n\n  getCell(x: number, y: number): any {\n    const v = this.instance.getDataAtCell(y, x);\n    if (v === null) return v;\n    else if (v === undefined) return \"\";\n    return \"\" + v;\n  }\n\n  getValue() {\n    return this.value;\n  }\n}\n\nexport default Cell;\n","import Handsontable from \"handsontable\";\nimport Cell from \"../components/Cell\";\nconst daff = require(\"daff\");\n\nexport function renderDiff(\n  instance: Handsontable.Core,\n  td: HTMLTableCellElement,\n  row: number,\n  col: number,\n  prop: string | number,\n  value: Handsontable.CellValue,\n  cellProperties: Handsontable.CellProperties\n): void {\n  const daffTable = new Cell(value, instance);\n  const view = new daff.SimpleView();\n  const cellInfo = daff.DiffRender.renderCell(daffTable, view, col, row);\n  td.className = cellInfo.category;\n  td.innerHTML = cellInfo.pretty_value;\n}\n","import React from \"react\";\nimport { HotTable } from \"@handsontable/react\";\nimport { renderDiff } from \"../utils/RenderDiffTable\";\nimport Handsontable from \"handsontable/base\";\n\ninterface DiffResult {\n  data: any[][];\n}\n\nconst DiffResultHooks: React.FC<DiffResult> = ({data}) => {\n  const hotDiffResultSettings : Handsontable.GridSettings = {\n    // minRows: 10,\n    // minCols: 10,\n    minSpareCols: 0,\n    minSpareRows: 0,\n    colHeaders: false,\n    contextMenu: false,\n    rowHeaders: false,\n    readOnly: true,\n    renderAllRows: true,\n    stretchH: \"all\",\n    licenseKey: \"non-commercial-and-evaluation\",\n  };\n\n  return (\n    <>\n      <div style={{ fontSize: 24, textAlign: 'center' }}>{\"比较结果\"}</div>\n      <HotTable\n        data={data}\n        settings={hotDiffResultSettings}\n        renderer={renderDiff}\n        className=\"diffhandsontable\"\n      />\n      {/* <div dangerouslySetInnerHTML={{ __html: data[1] }} /> */}\n    </>\n  );\n};\n\nexport default DiffResultHooks;\n","import { useState } from \"react\";\nimport { Row, Col, Layout } from \"antd\";\nimport type { RcFile } from 'antd/es/upload/interface';\n\nimport { convertFileToExcel, getSheet, SampleDataLeft, SampleDataRight, BlankData } from \"./utils/ExcelHelper\";\nimport type { ExcelDomain } from \"./utils/ExcelHelper\";\n\nimport { diff } from \"./utils/Diff\";\nimport LeftHooks from \"./components/Left\";\nimport CenterHooks from \"./components/Center\";\nimport DiffResultHooks from \"./components/DiffResult\";\n\nimport \"./App.css\";\n\nconst initialData: ExcelDomain = {\n  sheetname: \"Sheet1\",\n  sheets: [],\n  items: BlankData(12, 8),\n  workbook: undefined,\n  fileList: []\n}\n\nfunction App() {\n\n  const [leftDomain, setLeftDomain] = useState<ExcelDomain>(initialData);\n  const [rightDomain, setRightDomain] = useState<ExcelDomain>(initialData);\n\n  const [diffData, setDiffData] = useState<[any[][], string]>([[], '']);\n\n  const fileHandler = (file: RcFile | null, field: string) => {\n    if (file === null) {\n      if (field === \"left\") {\n        setLeftDomain(initialData)\n      } else {\n        setRightDomain(initialData)\n      }\n    } else {\n      convertFileToExcel(file).then((resp) => {\n        if (field === \"left\") {\n          setLeftDomain(resp);\n        } else {\n          setRightDomain(resp);\n        }\n      });\n    }\n  };\n\n  const onSheetFieldChange = (selectedSheetName: string, field: string) => {\n    var wb = field === \"left\" ? leftDomain.workbook : rightDomain.workbook;\n\n    if (wb) {\n      getSheet(wb, selectedSheetName).then((resp) => {\n        if (field === \"left\") {\n          setLeftDomain({ ...leftDomain, sheetname: selectedSheetName, items: resp })\n        } else {\n          setRightDomain({ ...rightDomain, sheetname: selectedSheetName, items: resp })\n        }\n      }\n      );\n    }\n  };\n\n  const onRset = () => {\n    setLeftDomain(initialData)\n    setRightDomain(initialData)\n    setDiffData([[], '']);\n  }\n\n  const onDiff = () => {\n    setDiffData(diff(leftDomain.items, rightDomain.items))\n  }\n\n  const onSample = () => {\n    setLeftDomain({ ...leftDomain, items: SampleDataLeft })\n    setRightDomain({ ...rightDomain, items: SampleDataRight })\n  }\n\n  return (\n    <Layout style={{ minHeight: \"100vh\" }}>\n      <Layout.Content>\n        <Row gutter={[24, 24]} style={{ padding: '4px' }}>\n          <Col span={11}>\n            <LeftHooks\n              data={leftDomain}\n              onFileSelectChange={(e) => fileHandler(e, \"left\")}\n              onSheetSelectChange={(e) => onSheetFieldChange(e, \"left\")}\n            />\n          </Col>\n          <Col span={2} style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"center\" }}>\n            <CenterHooks onDiff={onDiff} onSample={onSample} onReset={onRset} />\n          </Col>\n          <Col span={11}>\n            <LeftHooks\n              data={rightDomain}\n              onFileSelectChange={(e) => fileHandler(e, \"right\")}\n              onSheetSelectChange={(value) => onSheetFieldChange(value, \"right\")}\n            />\n          </Col>\n          {\n            diffData[0].length > 0 && <Col span={24}>\n              <DiffResultHooks data={diffData[0]} />\n            </Col>\n          }\n        </Row>\n      </Layout.Content>\n    </Layout>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom/client'\nimport { ConfigProvider } from 'antd';\nimport zhCN from 'antd/es/locale/zh_CN'\n\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport \"antd/dist/antd.css\";\nimport 'handsontable/dist/handsontable.full.min.css';\nimport { registerAllModules } from 'handsontable/registry';\n\nregisterAllModules();\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <ConfigProvider\n      locale={zhCN}\n      componentSize=\"middle\"\n    >\n      <App />\n    </ConfigProvider>\n  </React.StrictMode>,\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}